{
    "contents" : "source(\"C:/Users/taudiere/Dropbox/3-THESE/Article T stats/Package Tstats//function_CVNND.R\")\nsource(\"C:/Users/taudiere/Dropbox/3-THESE/Article T stats/Package Tstats//function_Tstats.r\")\nsource(\"C:/Users/taudiere/Dropbox/3-THESE/Article T stats/Package Tstats//function_variance.R\")\nsource(\"C:/Users/taudiere/Dropbox/3-THESE/Article T stats/Aiba et al 2013 avec na.rm=T.r\")\nsource(\"C:/Users/taudiere/Dropbox/3-THESE/Article T stats/Aiba et al 2013 modif.r\")\n\n\nfinch <- read.csv(\"C:/Users/taudiere/Dropbox/Analyses en cours/Tstats sur pinson/Morph_for_Sato.csv\", sep=\";\")\n#attention il faut changer les virgule en \".\" dans le fichier texte enqui car sinon on obtient des facteurs pour certains traits avec des NA qui s'ajoutent lorsqu'on passe en as.numeric\n\ntraits.finch<-finch[finch$IslandID!=\"Cocos\",11:14]\nTsp.finch<-as.factor(as.vector(paste(finch[finch$IslandID!=\"Cocos\",4],finch[finch$IslandID!=\"Cocos\",5], sep=\"_\")))\nind.plot_finch<-as.factor(as.vector(finch$IslandID[finch$IslandID!=\"Cocos\"]))\n\n\n\n\n#####plot.dens####\n\nplot.dens(traits.finch, Tsp.finch, ind.plot_finch, ylim.cex=3)\nplot.dens(traits.finch, ind.plot_finch, Tsp.finch, ylim.cex=8)\nplot.dens(traits.finch, rep(\"region\", times=dim(traits.finch)[1]), Tsp.finch, ylim.cex=6)\nplot.dens(traits.finch, rep(\"toutes_sp\", times=dim(traits.finch)[1]), ind.plot_finch,ylim.cex=3)\n\nplot.dens(traits.finch, Tsp.finch, ind.plot_finch, ylim.cex=3, sort.by.trait=T)\nplot.dens(traits.finch, ind.plot_finch, Tsp.finch, ylim.cex=3, sort.by.trait=T)\n\n\n\n\n\n\n\n#####partvar####\n\n\n\nplot.partvar<-as.factor(as.vector(ind.plot_finch))\nsp.partvar<-as.factor(as.vector(Tsp.finch))\n\nres.patrvar.finch<-partvar(traits=traits.finch, factors=cbind(plot.partvar, sp.partvar))\npar(mar=c(0.5,0.4,0.4,0.2), cex=0.5)\npie.partvar(res.patrvar.finch, col=c(\"red\", \"green\", \"blue\"))\npar(mar=c(5,4,4,2), cex=1)\n\nbar.partvar(res.patrvar.finch, col=c(\"red\", \"green\", \"blue\"))\n\n\n\n\n\n\n\n\n\n#####Tstats####\n\nres.finch<-Tstats(traits.finch, Tind_plot=ind.plot_finch, Tsp=Tsp.finch, nperm=99)\n\n\nsvg(\"Rplot%03d.svg\", width = 5, height = 5) #sauvegarde dans dossier document\n\ndev.off()\n\nplot.ses.Tstats(res.finch)\nplot.ses.Tstats(res.finch, type=\"color_cond\")\nplot.ses.Tstats(res.finch, type=\"simple\")\nplot.ses.Tstats(res.finch, type=\"simple_range\")\nplot.ses.Tstats(res.finch, type=\"barplot\")\n\n\nplot.bar.Tstats(res.finch)\nsummary.Tstats(res.finch)\n\nplot.cor.Tstats(res.finch)\n\n\n\n\n#####Community index####\n\n\nname_gen_site.finch=paste(finch[finch$IslandID!=\"Cocos\",4],finch[finch$IslandID!=\"Cocos\",4], finch$IslandID[finch$IslandID!=\"Cocos\"], sep=\"_\")\nname_sp_site.finch=paste(finch[finch$IslandID!=\"Cocos\",4],finch[finch$IslandID!=\"Cocos\",5], finch$IslandID[finch$IslandID!=\"Cocos\"], sep=\"_\")\n\nres.finch.gen<-com.index.c(traits=traits.finch, ind.plot=ind.plot_finch, nperm=99, name_sp_plot=name_gen_site.finch, pop.aggregate=TRUE)\nres.finch.sp<-com.index.c(traits=traits.finch, ind.plot=ind.plot_finch, nperm=99, name_sp_plot=name_sp_site.finch, pop.aggregate=TRUE)\nres.finch.ind<-com.index.c(traits=traits.finch, ind.plot=ind.plot_finch, nperm=99, name_sp_plot=name_sp_site.finch, pop.aggregate=F)\n\n\n\n\n\nrownames(res.finch$T_IP.IC)<-levels(ind.plot_finch)\nindex.list<-list(T_IP.IC=res.finch$T_IP.IC, T_IP.IC_nm=res.finch$T_IP.IC_nm, \n                 T_IC.IR=res.finch$T_IC.IR, T_IC.IR_nm=res.finch$T_IC.IR_nm, \n                 T_PC.PR=res.finch$T_PC.PR, T_PC.PR_nm=res.finch$T_PC.PR_nm,\n                 range.ind=res.finch.ind$Range_obs, range.ind.null=res.finch.ind$Null_range,\n                 mean.ind=res.finch.ind$Mean_obs, mean.ind.null=res.finch.ind$Null_mean,\n                 CV.ind=res.finch.ind$CV.NND_obs, CV.ind.null=res.finch.ind$Null_CV,\n                 kurtosis.ind=res.finch.ind$kurtosis_obs, kurtosis.ind.null=res.finch.ind$Null_kurtosis,\n                 range.sp=res.finch.sp$Range_obs, range.sp.null=res.finch.sp$Null_range,\n                 mean.sp=res.finch.sp$Mean_obs, mean.sp.null=res.finch.sp$Null_mean,\n                 CV.sp=res.finch.sp$CV.NND_obs, CV.sp.null=res.finch.sp$Null_CV,\n                 kurtosis.sp=res.finch.sp$kurtosis_obs, kurtosis.sp.null=res.finch.sp$Null_kurtosis)         \n\nplot.filter.c(com.object.ind=res.finch.ind, com.object.sp=res.finch.sp, tstats=res.finch, val.quant=c(0.025, 0.975), byplot=TRUE )\nplot.filter.c(com.object.ind=res.finch.ind, com.object.sp=res.finch.sp, tstats=res.finch, val.quant=c(0.025, 0.975), byplot=FALSE )\nplot.filter.c(com.object.ind=res.finch.ind, com.object.sp=res.finch.gen, tstats=res.finch, val.quant=c(0.025, 0.975), byplot=FALSE )\n\nplot.filter(index.list)\nplot.ses(index.list)\nplot.ses.var(index.list, table(ind.plot_finch))\n\n\nplot.filter(list(range.ind=res.finch.ind$Range_obs, range.ind.null=res.finch.ind$Null_range,\n                 mean.ind=res.finch.ind$Mean_obs, mean.ind.null=res.finch.ind$Null_mean,\n                 CV.ind=res.finch.ind$CV.NND_obs, CV.ind.null=res.finch.ind$Null_CV,\n                 kurtosis.ind=res.finch.ind$kurtosis_obs, kurtosis.ind.null=res.finch.ind$Null_kurtosis))\n\nplot.filter(list(T_IP.IC=res.finch$T_IP.IC, T_IP.IC_nm=res.finch$T_IP.IC_nm, \n                 T_IC.IR=res.finch$T_IC.IR, T_IC.IR_nm=res.finch$T_IC.IR_nm, \n                 T_PC.PR=res.finch$T_PC.PR, T_PC.PR_nm=res.finch$T_PC.PR_nm))\n\n\n\nplot.com(res.finch.gen)\nplot.com(res.finch.sp)\nplot.com(res.finch.ind)\n\n\n\n\nrequire(rasterVis)\n# Custom theme (from rasterVis package)\nmy.theme <- BuRdTheme()\n\n# Customize the colorkey\nmy.ckey <- list(col=my.theme$regions$col)\n\n\nlevelplot(t(mat.comm(com.object=res.finch.ind, tstats=res.finch)), colorkey=my.ckey, par.settings=my.theme, border=\"black\")\nlevelplot(t(mat.comm(com.object=res.finch.ind, tstats=res.finch, method=\"ses\")), colorkey=my.ckey, par.settings=my.theme,  border=\"black\")\n\n\n\n\n\n\n\n\n# Hypervolume\nind.plot_finch\nTsp.finch\n\nhv.finch.geo_scan = hypervolume(na.omit(traits.finch[Tsp.finch==\"Geospiza_scandens\",]),reps=1000,bandwidth=0.2)\nhv.finch.geo_fuli = hypervolume(na.omit(traits.finch[Tsp.finch==\"Geospiza_fuliginosa\",]),reps=1000,bandwidth=0.2)\n\nplot(hv.finch)\nhypervolume_importance(hv.finch)\nhypervolume_set(hv.finch.geo_scan,hv.finch.geo_fuli)\n\n\n#mice to complete the dataset\nmice<-mice(traits.finch)\ntraits.finch.hv<-complete(mice)\n  \nby(traits.finch.hv, Tsp.finch, function(x) hypervolume(x))@Volume\n\nby(traits.finch.hv, Tsp.finch, function(x) hypervolume(x))@Volume\n\n\n\n\nnames_sp_ind_plot<-as.factor(paste(Tsp.finch, ind.plot_finch, sep=\"@\")) \nTplotsp=unlist(strsplit(levels(names_sp_ind_plot),split=\"@\"))[2*(1:nlevels(names_sp_ind_plot))]; names(Tplotsp)=levels(names_sp_ind_plot);\n\n\n\n\nmean_IP<-aggregate(traits.finch.hv, list(paste(ind.plot_finch, Tsp.finch)), mean, na.rm=T)[,-1]\n\nby(mean_IP, as.factor(as.vector(Tplotsp)), function(x) hypervolume(x, reps=reps, bandwidth=bandwidth)@Volume)\n\n\nhv_IP<-hypervolume(traits,reps=reps,bandwidth=bandwidth)@Volume\n\nhv_IP.IC<-\n\n\n  Tstats.hv(traits.finch.hv, ind.plot_finch, Tsp.finch)\n\n\n\n\n\n\n\n\n\n",
    "created" : 1392742699494.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3247309461",
    "id" : "FB0914BE",
    "lastKnownWriteTime" : 1392742689,
    "path" : "C:/Users/taudiere/Dropbox/3-THESE/Article T stats/Package Tstats/exemple finch.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}